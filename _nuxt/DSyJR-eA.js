const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C-yEWnrd.js","./Dryw_uLv.js","./entry.DGrm56lQ.css","./BNsOAT4Y.js"])))=>i.map(i=>d[i]);
import{ab as N,ac as w,_ as T}from"./Dryw_uLv.js";import{t as b}from"./BNsOAT4Y.js";const h=(n,o)=>{const e=n._conditions;return e.length>0?`(${e.join(` ${o} `)})`:""},f=n=>{const o=[],e={_conditions:o,where(r,s,t){let i;switch(s.toUpperCase()){case"IN":case"NOT IN":if(Array.isArray(t)){const c=t.map(l=>`'${l}'`).join(", ");i=`"${String(r)}" ${s.toUpperCase()} (${c})`}else throw new TypeError(`Value for ${s} must be an array`);break;case"BETWEEN":case"NOT BETWEEN":if(Array.isArray(t)&&t.length===2)i=`"${String(r)}" ${s.toUpperCase()} '${t[0]}' AND '${t[1]}'`;else throw new Error(`Value for ${s} must be an array with two elements`);break;case"IS NULL":case"IS NOT NULL":i=`"${String(r)}" ${s.toUpperCase()}`;break;case"LIKE":case"NOT LIKE":i=`"${String(r)}" ${s.toUpperCase()} '${t}'`;break;default:i=`"${String(r)}" ${s} '${t}'`}return o.push(`${i}`),e},andWhere(r){const s=r(f());return o.push(h(s,"AND")),e},orWhere(r){const s=r(f());return o.push(h(s,"OR")),e}};return e},A=(n,o)=>{const e={conditions:[],selectedFields:[],offset:0,limit:0,orderBy:[],count:{field:"",distinct:!1}},r={__params:e,andWhere(t){const i=t(f());return e.conditions.push(h(i,"AND")),r},orWhere(t){const i=t(f());return e.conditions.push(h(i,"OR")),r},path(t){return r.where("path","=",N(t))},skip(t){return e.offset=t,r},where(t,i,c){return r.andWhere(l=>l.where(String(t),i,c)),r},limit(t){return e.limit=t,r},select(...t){return t.length&&e.selectedFields.push(...t),r},order(t,i){return e.orderBy.push(`"${String(t)}" ${i}`),r},async all(){return o(n,s()).then(t=>t||[])},async first(){return o(n,s({limit:1})).then(t=>t[0]||null)},async count(t="*",i=!1){return o(n,s({count:{field:String(t),distinct:i}})).then(c=>c[0].count)}};function s(t={}){let i="SELECT ";if(t!=null&&t.count)i+=`COUNT(${t.count.distinct?"DISTINCT":""} ${t.count.field}) as count`;else{const l=Array.from(new Set(e.selectedFields));i+=l.length>0?l.map(a=>`"${String(a)}"`).join(", "):"*"}i+=` FROM ${b[String(n)]}`,e.conditions.length>0&&(i+=` WHERE ${e.conditions.join(" AND ")}`),e.orderBy.length>0?i+=` ORDER BY ${e.orderBy.join(", ")}`:i+=" ORDER BY stem ASC";const c=(t==null?void 0:t.limit)||e.limit;return c>0&&(e.offset>0?i+=` LIMIT ${c} OFFSET ${e.offset}`:i+=` LIMIT ${c}`),i}return r};function C(n){return{type:"root",children:n.value.map(S)}}function S(n){if(typeof n=="string")return{type:"text",value:n};const[o,e,...r]=n;return{type:"element",tag:o,props:e,children:r.map(S)}}const E=/^h([1-6])$/,I=n=>E.test(n);async function L(n,o){const{ignoredTags:e=[]}={};return(await n.where("extension","=","md").select("path","body","description","title").all()).flatMap(s=>O(s,{ignoredTags:e}))}function O(n,{ignoredTags:o}){var l,a,m,y;const e=!n.body||((l=n.body)==null?void 0:l.type)==="root"?n.body:C(n.body),r=n.path??"",s=[{id:r,title:n.title||"",titles:[],content:(n.description||"").trim(),level:1}];if(!(e!=null&&e.children))return s;let t=1,i=0;const c=[n.title??""];for(const d of e.children){const $=d.tag||"";if(I($)){const u=Number(((a=$.match(E))==null?void 0:a[1])??0),g=p(d).trim();u===1?c.splice(0,c.length):u<i?c.splice(u-1,c.length-1):u===i&&c.pop(),s.push({id:`${r}#${(m=d.props)==null?void 0:m.id}`,title:g,titles:[...c],content:"",level:u}),c.push(g),i=u,t+=1}else{const u=p(d,o).trim();if(t===1&&((y=s[t-1])==null?void 0:y.content)===u)continue;s[t-1].content=`${s[t-1].content} ${u}`.trim()}}return s}function p(n,o=[]){var r;let e="";return n.type==="text"&&(e+=n.value||""),o.includes(n.tag??"")?"":((r=n.children)!=null&&r.length&&(e+=n.children.map(s=>p(s,o)).filter(Boolean).join("")),e)}const _=n=>{var e,r;const o=(r=(e=w())==null?void 0:e.ssrContext)==null?void 0:r.event;return A(n,(s,t)=>x(o,s,t))};async function U(n,o){return L(_(n))}async function x(n,o,e){return B(o,e)}async function B(n,o){return await T(()=>import("./C-yEWnrd.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(r=>r.loadDatabaseAdapter(n)).then(r=>r.all(o))}export{U as a,C as d,_ as q};
